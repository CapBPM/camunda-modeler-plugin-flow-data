{"version":3,"file":"client.js","mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACzPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;AACA","sources":["webpack://camunda-modeler-plugin-view-inputs-and-outputs/./client/data-flow-plugin/FlowDataPlugin.js","webpack://camunda-modeler-plugin-view-inputs-and-outputs/./node_modules/camunda-modeler-plugin-helpers/index.js","webpack://camunda-modeler-plugin-view-inputs-and-outputs/webpack/bootstrap","webpack://camunda-modeler-plugin-view-inputs-and-outputs/webpack/runtime/define property getters","webpack://camunda-modeler-plugin-view-inputs-and-outputs/webpack/runtime/hasOwnProperty shorthand","webpack://camunda-modeler-plugin-view-inputs-and-outputs/webpack/runtime/make namespace object","webpack://camunda-modeler-plugin-view-inputs-and-outputs/./client/index.js"],"sourcesContent":["const PLUGIN_NAME = 'CAMUNDA_MODELER_PLUGIN_VIEW_INPUTS_AND_OUTPUTS';\r\n\r\nclass FlowDataPlugin {\r\n  // Map<string, FlowDataBadge>\r\n  overlays = new Map();\r\n\r\n  constructor(eventBus, overlays, elementRegistry, canvas) {\r\n    this.modelerEventBus = eventBus;\r\n    this.modelerOverlays = overlays;\r\n    this.modelerElementRegistry = elementRegistry;\r\n    this.onConnectionAddRemove();\r\n    this.onConnectionChanged();\r\n    this.onElementChanged();\r\n    this.markerToggle = canvas.toggleMarker.bind(canvas);\r\n  }\r\n\r\n  onElementChanged() {\r\n    this.modelerEventBus.on(['element.changed'], ({ element }) => {\r\n      const { outgoing } = element;\r\n      outgoing?.forEach((flow) => {\r\n        this.removeFlowData(flow);\r\n        this.addFlowData(flow);\r\n      });\r\n    });\r\n  }\r\n\r\n  onConnectionChanged() {\r\n    this.modelerEventBus.on(['connection.changed'], ({ element }) => {\r\n      this.updateFlowData(element);\r\n    });\r\n  }\r\n\r\n  onConnectionAddRemove() {\r\n    this.modelerEventBus.on(['connection.added', 'connection.removed'], ({ element, type }) => {\r\n      if (type === 'connection.added') {\r\n        this.addFlowData(element);\r\n      }\r\n      if (type === 'connection.removed') {\r\n        this.removeFlowData(element);\r\n      }\r\n    });\r\n  }\r\n\r\n  updateFlowData(flowEl) {\r\n    const isOpen = !!this.overlays.get(flowEl.id)?.isOpen;\r\n    this.removeFlowData(flowEl);\r\n    this.addFlowData(flowEl, isOpen);\r\n  }\r\n\r\n  addFlowData(flowEl, isOpen = false) {\r\n    const exampleData = this.findExampleData(flowEl) || this.findExampleData(flowEl.source);\r\n    if (this.isValidData(exampleData)) {\r\n      const flowDataBadge = new FlowDataBadge(flowEl, this.modelerOverlays, this.markerToggle, exampleData, isOpen);\r\n      this.overlays.set(flowEl.id, flowDataBadge);\r\n    }\r\n  }\r\n\r\n  removeFlowData(flowEl) {\r\n    const flowDataBadge = this.overlays.get(flowEl.id);\r\n    if (flowDataBadge) {\r\n      this.overlays.delete(flowEl.id);\r\n      this.modelerOverlays.remove(flowDataBadge.overlayId);\r\n      flowDataBadge.destroy();\r\n    }\r\n  }\r\n\r\n  isValidData(exampleData) {\r\n    try {\r\n      JSON.parse(exampleData);\r\n      return true;\r\n    } catch (error) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  findExampleData(element) {\r\n    const values = element?.businessObject?.extensionElements?.values\r\n    if (!values?.length) return '';\r\n    for (const val of values) {\r\n      for (const property of val.properties || []) {\r\n        if (property.name === 'camundaModeler:exampleOutputJson') {\r\n          return property.value;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nFlowDataPlugin.$inject = [\r\n  'eventBus',\r\n  'overlays',\r\n  'elementRegistry',\r\n  'canvas',\r\n];\r\n\r\nclass FlowDataBadge {\r\n\r\n  constructor(flow, overlays, toggleMarker, data, isOpen = false) {\r\n    this.flow = flow;\r\n    this.isOpen = isOpen;\r\n    this.markerToggle = toggleMarker;\r\n    this.data = data;\r\n    this.position = { top: this.getTopShifth(), left: this.getLeftShift() };\r\n    this.overlayId = overlays.add(flow, { position: this.position, html: this.getHtml(data) });\r\n    this.badge = overlays.get(this.overlayId).htmlContainer;\r\n    this.toggleBadgeView();\r\n    this.onToggleBtnEvents();\r\n  }\r\n\r\n  onToggleBtnMouseenter = () => { this.markerToggle(this.flow, 'flow-highlight'); }\r\n  onToggleBtnMouseleave = () => { this.markerToggle(this.flow, 'flow-highlight'); }\r\n  onToggleBtnClick = () => {\r\n    this.isOpen = !this.isOpen;\r\n    this.toggleBadgeView();\r\n  }\r\n\r\n  destroy() {\r\n    this.toggleBtn.removeEventListener('mouseenter', this.onToggleBtnMouseenter);\r\n    this.toggleBtn.removeEventListener('mouseleave', this.onToggleBtnMouseleave);\r\n    this.toggleBtn.removeEventListener('click', this.onToggleBtnClick);\r\n  }\r\n\r\n  get toggleBtn() {\r\n    return this.badge.querySelector('.flow-data-toggle-btn');\r\n  }\r\n\r\n  get content() {\r\n    return this.badge.querySelector('.flow-data-content');\r\n  }\r\n\r\n  getLeftShift() {\r\n    const coordinatesX = this.flow.waypoints.map(({ x }) => x);\r\n    const [pointA, pointB] = this.flow.waypoints;\r\n    const direction = this.getLineDirection(pointA, pointB);\r\n    const minX = Math.min(...coordinatesX);\r\n    const shift = direction === 'W' ? -65 : 15;\r\n    return pointA.x - minX + shift;\r\n  }\r\n\r\n  getTopShifth() {\r\n    const coordinatesY = this.flow.waypoints.map(({ y }) => y);\r\n    const [pointA, pointB] = this.flow.waypoints;\r\n    const direction = this.getLineDirection(pointA, pointB);\r\n    const minY = Math.min(...coordinatesY);\r\n    const shift = direction === 'N' ? -25 : 25;\r\n    return pointA.y - minY + shift;\r\n  }\r\n\r\n  getLineDirection(pointA, pointB) {\r\n    if (pointA.x === pointB.x) {\r\n      if (pointA.y > pointB.y) return 'N';\r\n      if (pointA.y < pointB.y) return 'S';\r\n    }\r\n    if (pointA.y === pointB.y) {\r\n      if (pointA.x > pointB.x) return 'W';\r\n      if (pointA.x < pointB.x) return 'E';\r\n    }\r\n    if (pointA.x > pointB.x) {\r\n      if (pointA.y > pointB.y) return 'NW';\r\n      if (pointA.y < pointB.y) return 'SW';\r\n    }\r\n    if (pointA.x < pointB.x) {\r\n      if (pointA.y > pointA.x) return 'NE';\r\n      if (pointA.y < pointA.x) return 'SE';\r\n    }\r\n  }\r\n\r\n  getHtml(content) {\r\n    const parsed = JSON.parse(content);\r\n    const pretty = JSON.stringify(parsed, null, 2);\r\n    const btnContent = JSON.stringify(parsed);\r\n    return `\r\n      <div class=\"flow-data\">\r\n        <div class=\"flow-data-content\">\r\n          <pre>${pretty}</pre>\r\n        </div>\r\n        <button class=\"flow-data-toggle-btn\">${btnContent}</button>\r\n      </div>`\r\n  }\r\n\r\n  onToggleBtnEvents() {\r\n    this.toggleBtn.addEventListener('mouseenter', this.onToggleBtnMouseenter);\r\n    this.toggleBtn.addEventListener('mouseleave', this.onToggleBtnMouseleave);\r\n    this.toggleBtn.addEventListener('click', this.onToggleBtnClick);\r\n  }\r\n\r\n  toggleBadgeView() {\r\n    this.toggleBtn.textContent = this.isOpen ? 'Hide' : JSON.stringify(JSON.parse(this.data));\r\n    this.isOpen ? this.showFlowDataContent() : this.hideFlowDataContent();\r\n  }\r\n\r\n  showFlowDataContent() {\r\n    this.content.style.padding = `5px`;\r\n    this.content.style.width = `${this.content.scrollWidth + 5}px`;\r\n    this.content.style.height = `${this.content.scrollHeight}px`;\r\n    this.content.style.bottom = `${-1 * (this.content.scrollHeight + 5)}px`;\r\n    this.content.style.left = `${-((this.content.scrollWidth / 2) - 25)}px`;\r\n  }\r\n\r\n  hideFlowDataContent() {\r\n    this.content.style.width = '0px';\r\n    this.content.style.height = '0px';\r\n    this.content.style.padding = `0px`;\r\n  }\r\n}\r\n\r\nexport default {\r\n  __init__: [PLUGIN_NAME],\r\n  [PLUGIN_NAME]: ['type', FlowDataPlugin]\r\n};","/**\r\n * Validate and register a client plugin.\r\n *\r\n * @param {Object} plugin\r\n * @param {String} type\r\n */\r\nexport function registerClientPlugin(plugin, type) {\r\n  var plugins = window.plugins || [];\r\n  window.plugins = plugins;\r\n\r\n  if (!plugin) {\r\n    throw new Error('plugin not specified');\r\n  }\r\n\r\n  if (!type) {\r\n    throw new Error('type not specified');\r\n  }\r\n\r\n  plugins.push({\r\n    plugin: plugin,\r\n    type: type\r\n  });\r\n}\r\n\r\n/**\r\n * Validate and register a client plugin.\r\n *\r\n * @param {import('react').ComponentType} extension\r\n *\r\n * @example\r\n *\r\n * import MyExtensionComponent from './MyExtensionComponent';\r\n *\r\n * registerClientExtension(MyExtensionComponent);\r\n */\r\nexport function registerClientExtension(component) {\r\n  registerClientPlugin(component, 'client');\r\n}\r\n\r\n/**\r\n * Validate and register a bpmn-js plugin.\r\n *\r\n * @param {Object} module\r\n *\r\n * @example\r\n *\r\n * import {\r\n *   registerBpmnJSPlugin\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * const BpmnJSModule = {\r\n *   __init__: [ 'myService' ],\r\n *   myService: [ 'type', ... ]\r\n * };\r\n *\r\n * registerBpmnJSPlugin(BpmnJSModule);\r\n */\r\nexport function registerBpmnJSPlugin(module) {\r\n  registerClientPlugin(module, 'bpmn.modeler.additionalModules');\r\n}\r\n\r\n/**\r\n * Validate and register a platform specific bpmn-js plugin.\r\n *\r\n * @param {Object} module\r\n *\r\n * @example\r\n *\r\n * import {\r\n *   registerPlatformBpmnJSPlugin\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * const BpmnJSModule = {\r\n *   __init__: [ 'myService' ],\r\n *   myService: [ 'type', ... ]\r\n * };\r\n *\r\n * registerPlatformBpmnJSPlugin(BpmnJSModule);\r\n */\r\nexport function registerPlatformBpmnJSPlugin(module) {\r\n  registerClientPlugin(module, 'bpmn.platform.modeler.additionalModules');\r\n}\r\n\r\n/**\r\n * Validate and register a cloud specific bpmn-js plugin.\r\n *\r\n * @param {Object} module\r\n *\r\n * @example\r\n *\r\n * import {\r\n *   registerCloudBpmnJSPlugin\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * const BpmnJSModule = {\r\n *   __init__: [ 'myService' ],\r\n *   myService: [ 'type', ... ]\r\n * };\r\n *\r\n * registerCloudBpmnJSPlugin(BpmnJSModule);\r\n */\r\nexport function registerCloudBpmnJSPlugin(module) {\r\n  registerClientPlugin(module, 'bpmn.cloud.modeler.additionalModules');\r\n}\r\n\r\n/**\r\n * Validate and register a bpmn-moddle extension plugin.\r\n *\r\n * @param {Object} descriptor\r\n *\r\n * @example\r\n * import {\r\n *   registerBpmnJSModdleExtension\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * var moddleDescriptor = {\r\n *   name: 'my descriptor',\r\n *   uri: 'http://example.my.company.localhost/schema/my-descriptor/1.0',\r\n *   prefix: 'mydesc',\r\n *\r\n *   ...\r\n * };\r\n *\r\n * registerBpmnJSModdleExtension(moddleDescriptor);\r\n */\r\nexport function registerBpmnJSModdleExtension(descriptor) {\r\n  registerClientPlugin(descriptor, 'bpmn.modeler.moddleExtension');\r\n}\r\n\r\n/**\r\n * Validate and register a platform specific bpmn-moddle extension plugin.\r\n *\r\n * @param {Object} descriptor\r\n *\r\n * @example\r\n * import {\r\n *   registerPlatformBpmnJSModdleExtension\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * var moddleDescriptor = {\r\n *   name: 'my descriptor',\r\n *   uri: 'http://example.my.company.localhost/schema/my-descriptor/1.0',\r\n *   prefix: 'mydesc',\r\n *\r\n *   ...\r\n * };\r\n *\r\n * registerPlatformBpmnJSModdleExtension(moddleDescriptor);\r\n */\r\nexport function registerPlatformBpmnJSModdleExtension(descriptor) {\r\n  registerClientPlugin(descriptor, 'bpmn.platform.modeler.moddleExtension');\r\n}\r\n\r\n/**\r\n * Validate and register a cloud specific bpmn-moddle extension plugin.\r\n *\r\n * @param {Object} descriptor\r\n *\r\n * @example\r\n * import {\r\n *   registerCloudBpmnJSModdleExtension\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * var moddleDescriptor = {\r\n *   name: 'my descriptor',\r\n *   uri: 'http://example.my.company.localhost/schema/my-descriptor/1.0',\r\n *   prefix: 'mydesc',\r\n *\r\n *   ...\r\n * };\r\n *\r\n * registerCloudBpmnJSModdleExtension(moddleDescriptor);\r\n */\r\nexport function registerCloudBpmnJSModdleExtension(descriptor) {\r\n  registerClientPlugin(descriptor, 'bpmn.cloud.modeler.moddleExtension');\r\n}\r\n\r\n/**\r\n * Validate and register a dmn-moddle extension plugin.\r\n *\r\n * @param {Object} descriptor\r\n *\r\n * @example\r\n * import {\r\n *   registerDmnJSModdleExtension\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * var moddleDescriptor = {\r\n *   name: 'my descriptor',\r\n *   uri: 'http://example.my.company.localhost/schema/my-descriptor/1.0',\r\n *   prefix: 'mydesc',\r\n *\r\n *   ...\r\n * };\r\n *\r\n * registerDmnJSModdleExtension(moddleDescriptor);\r\n */\r\nexport function registerDmnJSModdleExtension(descriptor) {\r\n  registerClientPlugin(descriptor, 'dmn.modeler.moddleExtension');\r\n}\r\n\r\n/**\r\n * Validate and register a dmn-js plugin.\r\n *\r\n * @param {Object} module\r\n *\r\n * @example\r\n *\r\n * import {\r\n *   registerDmnJSPlugin\r\n * } from 'camunda-modeler-plugin-helpers';\r\n *\r\n * const DmnJSModule = {\r\n *   __init__: [ 'myService' ],\r\n *   myService: [ 'type', ... ]\r\n * };\r\n *\r\n * registerDmnJSPlugin(DmnJSModule, [ 'drd', 'literalExpression' ]);\r\n * registerDmnJSPlugin(DmnJSModule, 'drd')\r\n */\r\nexport function registerDmnJSPlugin(module, components) {\r\n\r\n  if (!Array.isArray(components)) {\r\n    components = [ components ]\r\n  }\r\n\r\n  components.forEach(c => registerClientPlugin(module, `dmn.modeler.${c}.additionalModules`)); \r\n}\r\n\r\n/**\r\n * Return the modeler directory, as a string.\r\n *\r\n * @deprecated Will be removed in future Camunda Modeler versions without replacement.\r\n *\r\n * @return {String}\r\n */\r\nexport function getModelerDirectory() {\r\n  return window.getModelerDirectory();\r\n}\r\n\r\n/**\r\n * Return the modeler plugin directory, as a string.\r\n *\r\n * @deprecated Will be removed in future Camunda Modeler versions without replacement.\r\n *\r\n * @return {String}\r\n */\r\nexport function getPluginsDirectory() {\r\n  return window.getPluginsDirectory();\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { registerBpmnJSPlugin } from 'camunda-modeler-plugin-helpers';\r\nimport FlowDataPlugin from './data-flow-plugin/FlowDataPlugin';\r\n\r\nregisterBpmnJSPlugin(FlowDataPlugin);\r\n"],"names":[],"sourceRoot":""}